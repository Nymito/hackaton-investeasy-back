# üß† AI Market Analyst (Backend)

Backend FastAPI (mocked version) for the hackathon project.

## üöÄ Run locally

```bash
pip install -r requirements.txt
uvicorn main:app --reload
```

Then open:
üëâ http://127.0.0.1:8000/docs

## üì¶ Endpoints

| Method | Route | Description |
|---------|--------|-------------|
| `POST` | `/analyze` | Returns a mock AI analysis (summary, competitors, score, similar ideas) |
| `GET` | `/` | Health check |

## üí° Next steps
- Replace mocks in `core/analysis.py` with real Mistral + Qdrant calls
- Add scoring logic and feedback loop

## üîé Similarity dataset

1. Place your CSV dataset (default: `unicorns till sep 2022.csv`) at the project root. Override with `STARTUP_DATASET_PATH` if needed.
2. Configure Qdrant credentials in `.env`: `QDRANT_URL`, `QDRANT_API_KEY`, optionally `QDRANT_COLLECTION`.
3. Sync the dataset vectors into Qdrant:

```bash
python -m core.startup_similarity  # uses Mistral embeddings + Qdrant
```

The `/analyze` endpoint now augments responses with similar startups based on cosine similarity against that collection.

## üîÅ n8n automation

Ship the analysis to the real world by plugging in n8n:

1. Start n8n (Docker `docker run -p 5678:5678 n8nio/n8n` or the desktop app), then import `spy_workflow.json` via **Import from File** and activate the workflow.
2. In the "Send email" node, configure your SMTP account (credential `SMTP account`).
3. Copy the webhook URL generated by n8n and set it in `.env`: `N8N_WEBHOOK_URL=https://.../webhook/...`. Restart FastAPI so it picks up the change.
4. From the frontend (or via `curl`), call `/trigger-agent` with `{ "idea": "...", "email": "...", "analysis": { ... } }`. The backend forwards that payload to n8n automatically.

The `/analyze` ‚Üí `/trigger-agent` duo lets the user read their analysis and decide when to run the agent (email, doc generation, etc.).

```bash
curl -X POST http://127.0.0.1:8000/trigger-agent \
  -H 'Content-Type: application/json' \
  -d '{"idea": "Ghost kitchen platform", "email": "founder@example.com", "analysis": {"summary": "..."}}'
```

> ‚ÑπÔ∏è The workflow currently targets local usage. Make sure n8n and FastAPI run on the same machine (or network) before sharing the webhook.
